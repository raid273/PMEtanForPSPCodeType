## PMEtanForPSP コード書式補足


### 一番単純な書き込み系
これはそのまんまです。

~~~
_CN0 通常書き込み
_NWR 0x10000000 0x00001000 0xFFFFFFFF 4bit
_NWR 0x20000000 0x00001010 0xFFFFFFFF 8bit
_NWR 0x30000000 0x00001020 0xFFFFFFFF 12bit
_NWR 0x40000000 0x00001030 0xFFFFFFFF 16bit
_NWR 0x50000000 0x00001040 0xFFFFFFFF 20bit
_NWR 0x60000000 0x00001050 0xFFFFFFFF 24bit
_NWR 0x70000000 0x00001060 0xFFFFFFFF 28bit
_NWR 0x80000000 0x00001070 0xFFFFFFFF 32bit

_CN0 論理演算 And
_NWR 0x10100000 0x00001000 0x88888888 4bit
_NWR 0x20100000 0x00001010 0x88888888 8bit
_NWR 0x30100000 0x00001020 0x88888888 12bit
_NWR 0x40100000 0x00001030 0x88888888 16bit
_NWR 0x50100000 0x00001040 0x88888888 20bit
_NWR 0x60100000 0x00001050 0x88888888 24bit
_NWR 0x70100000 0x00001060 0x88888888 28bit
_NWR 0x80100000 0x00001070 0x88888888 32bit

_CN0 論理演算 Or
_NWR 0x10200000 0x00001000 0x88888888 4bit
_NWR 0x20200000 0x00001010 0x88888888 8bit
_NWR 0x30200000 0x00001020 0x88888888 12bit
_NWR 0x40200000 0x00001030 0x88888888 16bit
_NWR 0x50200000 0x00001040 0x88888888 20bit
_NWR 0x60200000 0x00001050 0x88888888 24bit
_NWR 0x70200000 0x00001060 0x88888888 28bit
_NWR 0x80200000 0x00001070 0x88888888 32bit

_CN0 論理演算 Xor
_NWR 0x10300000 0x00001000 0xFFFFFFFF 4bit
_NWR 0x20300000 0x00001010 0xFFFFFFFF 8bit
_NWR 0x30300000 0x00001020 0xFFFFFFFF 12bit
_NWR 0x40300000 0x00001030 0xFFFFFFFF 16bit
_NWR 0x50300000 0x00001040 0xFFFFFFFF 20bit
_NWR 0x60300000 0x00001050 0xFFFFFFFF 24bit
_NWR 0x70300000 0x00001060 0xFFFFFFFF 28bit
_NWR 0x80300000 0x00001070 0xFFFFFFFF 32bit
~~~

---
### 滅多に使うことのないマスク系
一番下の桁が書き込まれないので、上の桁だけ書き込みたい場合に使います。

~~~
_CN0 通常マスク
_NWR 0x12000000 0x00001000 0xFFFFFFFF 4bit Mask
_NWR 0x22000000 0x00001010 0xFFFFFFFF 8bit Mask
_NWR 0x32000000 0x00001020 0xFFFFFFFF 12bitMask
_NWR 0x42000000 0x00001030 0xFFFFFFFF 16bitMask
_NWR 0x52000000 0x00001040 0xFFFFFFFF 20bitMask
_NWR 0x62000000 0x00001050 0xFFFFFFFF 24bitMask
_NWR 0x72000000 0x00001060 0xFFFFFFFF 28bitMask
_NWR 0x82000000 0x00001070 0xFFFFFFFF 32bitMask

_CN0 Andマスク
_NWR 0x12100000 0x00001000 0x88888888 4bit Mask
_NWR 0x22100000 0x00001010 0x88888888 8bit Mask
_NWR 0x32100000 0x00001020 0x88888888 12bitMask
_NWR 0x42100000 0x00001030 0x88888888 16bitMask
_NWR 0x52100000 0x00001040 0x88888888 20bitMask
_NWR 0x62100000 0x00001050 0x88888888 24bitMask
_NWR 0x72100000 0x00001060 0x88888888 28bitMask
_NWR 0x82100000 0x00001070 0x88888888 32bitMask

_CN0 Orマスク
_NWR 0x12200000 0x00001000 0x88888888 4bit Mask
_NWR 0x22200000 0x00001010 0x88888888 8bit Mask
_NWR 0x32200000 0x00001020 0x88888888 12bitMask
_NWR 0x42200000 0x00001030 0x88888888 16bitMask
_NWR 0x52200000 0x00001040 0x88888888 20bitMask
_NWR 0x62200000 0x00001050 0x88888888 24bitMask
_NWR 0x72200000 0x00001060 0x88888888 28bitMask
_NWR 0x82200000 0x00001070 0x88888888 32bitMask

_CN0 Xorマスク
_NWR 0x12300000 0x00001000 0xFFFFFFFF 4bit Mask
_NWR 0x22300000 0x00001010 0xFFFFFFFF 8bit Mask
_NWR 0x32300000 0x00001020 0xFFFFFFFF 12bitMask
_NWR 0x42300000 0x00001030 0xFFFFFFFF 16bitMask
_NWR 0x52300000 0x00001040 0xFFFFFFFF 20bitMask
_NWR 0x62300000 0x00001050 0xFFFFFFFF 24bitMask
_NWR 0x72300000 0x00001060 0xFFFFFFFF 28bitMask
_NWR 0x82300000 0x00001070 0xFFFFFFFF 32bitMask
~~~

---
### コピー＆ペースト＆比較
比較は直接アドレス指定ではなく、一度コピーしてから使用します。  
CWCと比べると比較一つごとに1行ずつ増えますが、32bit比較やOr条件の設定が可能です。

~~~
_CN0 コピー＆ペースト＆比較
_CPY 0x80000000 0x00001000 0x00000000 0x1000から32bitコピー
_TES 0x00000000 0x00000001 0x00001000 コピーした値が0x1000なら
_PST 0x80000000 0x00001008 0x00000000 0x1008にペースト
_TES 0x00100000 0x00000001 0000001000 0x1000でなければ
_PST 0x80000000 0x0000100C 0x00000000 0x100Cにペースト

_CN0 And
_CPY 0x80000000 0x00001000 0x00000000 0x1000から32bitコピー
_TES 0x00000000 0x00000003 0x00001000 それが0x1000かつ
_CPY 0x80000000 0x00001004 0x00000000 0x1004から32bitコピー
_TES 0x00000000 0x00000001 0x00002000 それが0x2000なら
_NWR 0x80000000 0x00001010 0xFFFFFFFF 書き込み

_CN0 Or
_CPY 0x80000000 0x00001000 0x00000000 0x1000から32bitコピー
_TES 0x00010000 0x00000003 0x00000000 0x0000又は
_TES 0x00010000 0x00000002 0x00001000 0x1000又は
_TES 0x00000000 0x00000001 0x00002000 0x2000なら
_NWR 0x80000000 0x00001010 0xFFFFFFFF 書き込み

コピーした値に対して演算が可能です。
_CPY 0x80000000 0x00001000 0x00000001 0x1000から32bitコピーして0x1を加算
_PST 0x80000000 0x00001000 0x00000000 0x1000に32bitペースト

複数回の演算も可能です。
_CPY 0x80000000 0x00001000 0x00000010 0x1000から32bitコピーして0x10を加算
_CPY 0x80210000 0x00000000 0x00000003 それを3倍にして
_PST 0x80000000 0x00001004 0x00000000 0x1004に32bitペースト
~~~

---
### シリアル化
~~~
0x00001000 に 0x00000000 を32bit(4Byte)分書き込む。それをアドレスを0x4ずつずらしながら0x3F回ループ。
_CN0 テスト領域初期化用 0x00埋め
_NWR 0x80000000 0x00001000 0x00000000
_MLS 0x00000000 0x00000004 0x0001003F

これをCWCで書くと下のようになります。
CWCのものと比べると、書き込み回数が-1されているのと、ずらすアドレスを書き込むByte数で割らなくてもOKな所が違います。
_L 0x40001000 0x00400001
_L 0x00000000 0x00000000

値もずらす場合は_OFFを追加します。
0x00001000 に 0x00000000 を32bit(4Byte)分書き込む。アドレスを0x4、値を0x1ずつずらしながら0x3F回ループ。
CWCと比べると1行多くなります。
_OFF 0x00100000 0x00000000 0x00000001
_NWR 0x80000000 0x00001000 0x00000000
_MLS 0x00000000 0x00000004 0x0002003F

比較のシリアル化や途中でのOffset変更も可
_NWR 0x20000000 0x00001004 0x00000000 0x1004基準
_OFF 0x00100000 0x00000000 0x00000001 ValueOffset=1
_NWR 0x20000000 0x00001000 0x00000000 0x1000基準
_CPY 0x20000000 0x00001000 0x00000000 0x1000基準コピー
_TES 0x00000000 0x00000002 0x00000005 5なら下2行実行
_OFF 0x00100000 0x00000000 0x00000000 ValueOffset=0
_PST 0x20000000 0x00001004 0x00000000 0x1004基準ペースト
_MLS 0x00000000 0x00000010 0x0007000F AdrOff=0x10,7行,0xF回
~~~

---
### ポインタ
~~~
_CN0 ポインタ
_NWR 0x80000000 0x00001000 0x08801008 ポインタ作成
_PIN 0x80000000 0x00001000 0x00000000 ベースアドレス設定
_PWR 0x80000000 0x00000008 0xFFFFFFFF 書き込み
_PWR 0x81000000 0x00000018 0xFFFFFFFF リバース書き込み

多重はPTRを追加するだけ
_CN0 多重ポインタ
_NWR 0x80000000 0x00001000 0x08801004 ポインタ作成
_NWR 0x80000000 0x00001008 0x0880100C ポインタ作成
_NWR 0x80000000 0x00001010 0x08801014 ポインタ作成
_NWR 0x80000000 0x00001018 0x0880101C ポインタ作成
_PIN 0x80000000 0x00001000 0x00000000 1000   =1004
_PTR 0x80000000 0x00000004 0x00000000 1004+ 4=1008(=100C)
_PTR 0x80000000 0x00000004 0x00000000 100C+ 4=1010(=1014)
_PTR 0x81000000 0x00000014 0x00000000 1014-14=1000(=1004)
_PWR 0x81000000 0x00000008 0x000003E7 1004- 8=0x0FFCに 0x000003E7 を書き込み

シリアル化は_MLSを追加するだけ
_CN0 多重ポインタのシリアル化
_NWR 0x80000000 0x00001000 0x08801004 ポインタ作成
_NWR 0x80000000 0x00001008 0x0880100C ポインタ作成
_NWR 0x80000000 0x00001010 0x08801014 ポインタ作成
_NWR 0x80000000 0x00001018 0x0880101C ポインタ作成
_PIN 0x80000000 0x00001000 0x00000000 1000   =1004
_PTR 0x80000000 0x00000004 0x00000000 1004+ 4=1008(=100C)
_PTR 0x80000000 0x00000004 0x00000000 100C+ 4=1010(=1014)
_PTR 0x81000000 0x00000014 0x00000000 1014-14=1000(=1004)
_PWR 0x81000000 0x00000008 0x000003E7 1004- 8=0x0FFCに 0x000003E7 を書き込み
_MLS 0x00000000 0x00000010 0x00050010 上5行(_PIN～_PWR)をアドレスを0x10ずつずらしながら0x10回スープ
~~~

---
### アドレスシフト
書き込みとコピーを行うアドレスをずらします。  
_MLSのAddressOffsetとは別扱い。

~~~
_CN0 シフト
_OFF 0x00010000 0x00000004 0x00000001 4*1ずらす
_OFF 0x00110000 0x00000004 0x00000001 4*1ずらす
_NWR 0x80000000 0x00001000 0xFFFFFFFF 1000+(4*1)+(4*1)=1008に0xFFFFFFFFを書き込み

アイテムやキャラクターのステータスの変更などに使えます。
真ん中に次のスロットへのオフセットを指定すれば、右を変えるだけで2番目、3番目に適用できます。
_CN0 キャラクターのステータスとか
_OFF 0x00010000 0x00000128 0x00000002 128*2ずらして3人目を対象にする
_NWR 0x80000000 0x00001000 0x000F423F 1000+(128*2)=1250に0x000F423Fを書き込み
_NWR 0x40000000 0x00001004 0x000003E7 1004+(128*2)=1254に0x03E7を書き込み
~~~
